
const puppeteer = require('puppeteer');

async function screenshotmaps () {  
  // load repository details for this array of repo URLs
  const urls = [{'loc_ref': 'loc_04',
  'display': 'NYAKASHARU, RUBIRIZI',
  'chan_id': 672528,
  'url': 'https://www.google.com/maps/@-0.265089,30.096887,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_05',
  'display': 'KISEKENDE, MUBENDE',
  'chan_id': 675740,
  'url': 'https://www.google.com/maps/@0.549748,31.386739,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_06',
  'display': 'CENTRAL, TORORO',
  'chan_id': 675801,
  'url': 'https://www.google.com/maps/@0.69393,34.171350000000004,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_07',
  'display': 'NYAHUKA, BUNDIBUGYO',
  'chan_id': 675805,
  'url': 'https://www.google.com/maps/@0.6740557,29.984028799999997,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_08',
  'display': 'NYENDO, MASAKA',
  'chan_id': 675851,
  'url': 'https://www.google.com/maps/@-0.321261,31.751157999999997,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_09',
  'display': 'KISANGA, KASESE',
  'chan_id': 675991,
  'url': 'https://www.google.com/maps/@0.178013,30.073665,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_10',
  'display': 'RWENGOMA, KABAROLE',
  'chan_id': 676000,
  'url': 'https://www.google.com/maps/@0.657624,30.25763,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_11',
  'display': 'NORTH EAST A, BUSIA',
  'chan_id': 689508,
  'url': 'https://www.google.com/maps/@0.465778,34.08485,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_13',
  'display': 'MASABA, MBALE',
  'chan_id': 689516,
  'url': 'https://www.google.com/maps/@1.076072,34.151669000000005,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_15',
  'display': 'CHEKWANDA, KAPCHORWA',
  'chan_id': 689520,
  'url': 'https://www.google.com/maps/@1.331978,34.362417,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_16',
  'display': 'BUGANA, NAMAYINGO',
  'chan_id': 689522,
  'url': 'https://www.google.com/maps/@0.201919,33.80724,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_17',
  'display': 'BULOLI NORTH, BUDUDA',
  'chan_id': 689525,
  'url': 'https://www.google.com/maps/@1.011247,34.321200000000005,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_18',
  'display': 'BUKIKALI, MBALE',
  'chan_id': 689530,
  'url': 'https://www.google.com/maps/@1.083978,34.223655,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_20',
  'display': 'CENTRAL WARD, SOROTI',
  'chan_id': 689749,
  'url': 'https://www.google.com/maps/@1.714471,33.611236000000005,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_21',
  'display': 'BUMURWA, NAMISINDWA',
  'chan_id': 689750,
  'url': 'https://www.google.com/maps/@0.926079,34.35183,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_22',
  'display': 'NKUSI, BUGIRI',
  'chan_id': 689752,
  'url': 'https://www.google.com/maps/@0.567539,33.74172,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_23',
  'display': 'MAGWA WARD, JINJA',
  'chan_id': 689753,
  'url': 'https://www.google.com/maps/@0.432968,33.20001,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_24',
  'display': 'NKAATU, IGANGA',
  'chan_id': 689756,
  'url': 'https://www.google.com/maps/@0.611445,33.460010000000004,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_25',
  'display': 'MARKET WARD, IGANGA',
  'chan_id': 689759,
  'url': 'https://www.google.com/maps/@0.776971,33.61392,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_26',
  'display': 'CIVIC CENTRE, KAMPALA',
  'chan_id': 689761,
  'url': 'https://www.google.com/maps/@0.314,32.580000000000005,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_27',
  'display': 'GASIZA, KISORO',
  'chan_id': 689766,
  'url': 'https://www.google.com/maps/@-1.283185,29.691433999999997,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_29',
  'display': 'BUGOLOBI, KAMPALA',
  'chan_id': 718028,
  'url': 'https://www.google.com/maps/@0.3075,32.610600000000005,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_30',
  'display': 'KIWAFU, WAKISO',
  'chan_id': 718029,
  'url': 'https://www.google.com/maps/@0.059604,32.450320000000005,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_31',
  'display': 'KIREKA, WAKISO',
  'chan_id': 718030,
  'url': 'https://www.google.com/maps/@0.347014,32.63936,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_32',
  'display': 'SEGUKU, WAKISO',
  'chan_id': 730014,
  'url': 'https://www.google.com/maps/@0.235668,32.54764,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_33',
  'display': 'BUWENGE NORTH WARD, JINJA',
  'chan_id': 730015,
  'url': 'https://www.google.com/maps/@0.65025,33.160830000000004,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_34',
  'display': 'WOBULENZI WEST, LUWERO',
  'chan_id': 730016,
  'url': 'https://www.google.com/maps/@0.718394,32.518060000000006,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_35',
  'display': 'GGULU WARD, MUKONO',
  'chan_id': 730019,
  'url': 'https://www.google.com/maps/@0.360752,32.74257,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_36',
  'display': 'BWEYOGERERE, WAKISO',
  'chan_id': 737273,
  'url': 'https://www.google.com/maps/@0.354825,32.66781,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_39',
  'display': 'LUBAGA, KAMPALA',
  'chan_id': 737276,
  'url': 'https://www.google.com/maps/@0.295314,32.543682000000004,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_40',
  'display': 'CENTRAL WARD, MITYANA',
  'chan_id': 737278,
  'url': 'https://www.google.com/maps/@0.400714,32.0322,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_41',
  'display': 'LOWER BUGONGI, KABALE',
  'chan_id': 755609,
  'url': 'https://www.google.com/maps/@-1.244985,29.979235999999997,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_43',
  'display': 'MAKINDYE I, KAMPALA',
  'chan_id': 755612,
  'url': 'https://www.google.com/maps/@0.289,32.579,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_44',
  'display': 'NAGURU II, KAMPALA',
  'chan_id': 755614,
  'url': 'https://www.google.com/maps/@0.3412,32.592,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_45',
  'display': 'KASUBI, KAMPALA',
  'chan_id': 782718,
  'url': 'https://www.google.com/maps/@0.344,32.543,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_46',
  'display': 'BUKASA, KAMPALA',
  'chan_id': 782719,
  'url': 'https://www.google.com/maps/@0.29875,32.605000000000004,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_47',
  'display': 'BUKUTO I, KAMPALA',
  'chan_id': 782720,
  'url': 'https://www.google.com/maps/@0.3517,32.581,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_48',
  'display': 'SEGUKU, WAKISO',
  'chan_id': 782721,
  'url': 'https://www.google.com/maps/@0.2336,32.5535,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_49',
  'display': 'LUKULI, KAMPALA',
  'chan_id': 782722,
  'url': 'https://www.google.com/maps/@0.2836,32.59,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_51',
  'display': 'LUKULI, KAMPALA',
  'chan_id': 832251,
  'url': 'https://www.google.com/maps/@0.299,32.582,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_52',
  'display': 'BUSABALA, WAKISO',
  'chan_id': 832252,
  'url': 'https://www.google.com/maps/@0.2182,32.607600000000005,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_53',
  'display': 'BUNMWAYA, WAKISO',
  'chan_id': 832253,
  'url': 'https://www.google.com/maps/@0.269993,32.548017,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_54',
  'display': 'KYEBANDO, KAMPALA',
  'chan_id': 832254,
  'url': 'https://www.google.com/maps/@0.3564,32.563,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_55',
  'display': 'KYANJA, KAMPALA',
  'chan_id': 832255,
  'url': 'https://www.google.com/maps/@0.3875,32.591,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_56',
  'display': 'BUSEGA, KAMPALA',
  'chan_id': 870139,
  'url': 'https://www.google.com/maps/@0.3101,32.506,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_57',
  'display': 'KYEBANDO, WAKISO',
  'chan_id': 870140,
  'url': 'https://www.google.com/maps/@0.3547,32.4926,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_58',
  'display': 'NANSANA EAST WARD, WAKISO',
  'chan_id': 870142,
  'url': 'https://www.google.com/maps/@0.3759,32.518,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_59',
  'display': 'KYALIWAJJALA, WAKISO',
  'chan_id': 870143,
  'url': 'https://www.google.com/maps/@0.381576,32.637109,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_60',
  'display': 'BUTABIKA, KAMPALA',
  'chan_id': 870144,
  'url': 'https://www.google.com/maps/@0.30778,32.641449,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_61',
  'display': 'KIWATULE, KAMPALA',
  'chan_id': 870145,
  'url': 'https://www.google.com/maps/@0.373078,32.618226,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_62',
  'display': 'MAKERERE UNIVERSITY, KAMPALA',
  'chan_id': 870146,
  'url': 'https://www.google.com/maps/@0.3323,32.5598,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_63',
  'display': 'NANSANA WEST WARD, WAKISO',
  'chan_id': 870147,
  'url': 'https://www.google.com/maps/@0.363,32.519000000000005,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_64',
  'display': 'KIRA, WAKISO',
  'chan_id': 912219,
  'url': 'https://www.google.com/maps/@0.391478,32.61583,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_65',
  'display': 'NAKASERO II, KAMPALA',
  'chan_id': 912220,
  'url': 'https://www.google.com/maps/@0.322108,32.566,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_66',
  'display': 'NAKASERO II, KAMPALA',
  'chan_id': 912221,
  'url': 'https://www.google.com/maps/@0.32232,32.5657,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_67',
  'display': 'MBUYA II, KAMPALA',
  'chan_id': 912222,
  'url': 'https://www.google.com/maps/@0.325346,32.622288000000005,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_68',
  'display': 'NAKAWA, KAMPALA',
  'chan_id': 912223,
  'url': 'https://www.google.com/maps/@0.341674,32.625306,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_69',
  'display': 'NANTABULIRWA WARD, MUKONO',
  'chan_id': 912224,
  'url': 'https://www.google.com/maps/@0.34646,32.69328,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_70',
  'display': 'KASENGE WAKISO',
  'chan_id': 912225,
  'url': 'https://www.google.com/maps/@0.286595,32.496107,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_71',
  'display': 'KIREKA, WAKISO',
  'chan_id': 930426,
  'url': 'https://www.google.com/maps/@0.3655,32.6368,15z/data=!5m1!1e1'},
 {'loc_ref': 'loc_72',
  'display': 'LUWAFU, KAMPALA',
  'chan_id': 930427,
  'url': 'https://www.google.com/maps/@0.2689,32.578,15z/data=!5m1!1e1'}]
;

  var today = new Date();
  var datestamp = "_" + today.getFullYear() + "-" + (today.getMonth()+1) + "-" + today.getDate() + "_" + today.getHours() + '-' + today.getMinutes() + '.png';

    urls.map(async run => {

        for (const [idx, pairs] of urls.entries()) {
            let browser = await puppeteer.launch();
            let page = await browser.newPage();
            await page.goto(pairs.url);
            await page.setViewport({ width: 1920, height: 1080 });
            await page.waitForNavigation(['load']);
            await page.screenshot({ path: './' + pairs.loc_ref +  '_' + datestamp, type: 'png' , 
            clip: { x: 550, y: 50, width: 1375, height: 889 } 
            });
        await page.close();
        await browser.close();
        };
    });
};

screenshotmaps ()


// References https://futurestud.io/tutorials/node-js-how-to-run-an-asynchronous-function-in-array-map
// https://medium.com/dailyjs/the-pitfalls-of-async-await-in-array-loops-cf9cf713bfeb
